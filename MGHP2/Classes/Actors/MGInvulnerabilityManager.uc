class MGInvulnerabilityManager extends Actor;

// MaxG: To be spawned by chocolate frogs and the like.

var float InvulnerableTime;

var float InitialTime;

function SetInvulnerableTime(float Time)
{
    InvulnerableTime = Time;
}

event BeginPlay()
{
    local MGInvulnerabilityManager invuln_mgr;
    Super.BeginPlay();

    // MaxG: Delete all other invuln managers so they do not interfere.
    forEach AllActors(Class'MGInvulnerabilityManager', invuln_mgr)
    {
        if (invuln_mgr != Self)
        {
            invuln_mgr.Destroy();
        }
    }

    InitialTime = Level.TimeSeconds;

    // MaxG: Make invulnerable.
    MGHarry(Level.PlayerHarryActor).Invulnerable();
}

event Tick(float DeltaTime)
{
    Super.Tick(DeltaTime);

    // MaxG: Make the health bar green.
    Harry(Level.PlayerHarryActor).AddHealth(0);

    if ( (Level.TimeSeconds - InitialTime) >= InvulnerableTime )
    {
        MGHarry(Level.PlayerHarryActor).Vulnerable();

        Destroy();
    }
}

defaultproperties
{
    bHidden=True
}